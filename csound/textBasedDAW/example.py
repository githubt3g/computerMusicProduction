# . = silence  1 = sample  2 = sample with delay1  3 = sample with delay2  4 = sample with reverb1  5 = sample with reverb2
# 6 = sample with delay1 and reverb1   7 = sample with delay1 and reverb2  8 = sample with delay2 and reverb1  9 = sample with delay2 and reverb2
from os import system
import sys
sys.stdout = open("./example.csd", "w") # redirect print to file
import re
t32='''bpm = 128  
      r1    r2         d1  d2
send 1.00  1.00  send 1.00 1.00
time 5.00  5.00  fdbk 0.70 0.50
                                                           4-bar choices         8-bar choices       256-bar song
               bar                   bar                   -------------------   -----------------   -----------------------------------------   
               0                     1                     a    b    c    d      A  B  C  D  E  F   >                   <
s01 kick       1... 1... 1... 1...   1... 1... 1... 1...   0001 0011 0100 0101   ab ac ad bc bd cd   ABCD ABCD ABCD ABCD   ABCD ABCD ABCD ABCD   1
s02 snare      .... 1... .... 1...   .... 1... .... 6...   0001 0001 0001 0011   aa ad aa ad aa ad   ABCD ABCD ABCD ABCD   ABCD ABCD ABCD ABCD   0
s03 clap       .... .... .... ....   .... .... .... ....   .... .... .... ....   .. .. .. .. .. ..   .... .... .... ....   .... .... .... ....   0
s04 stick      .... .... .... ....   .... .... .... ....   .... .... .... ....   .. .. .. .. .. ..   .... .... .... ....   .... .... .... ....   0
s05 chh        .... .... .... ....   .... .... .... ....   .... .... .... ....   .. .. .. .. .. ..   .... .... .... ....   .... .... .... ....   0
s06 ohh        .... .... .... ....   .... .... .... ....   .... .... .... ....   .. .. .. .. .. ..   .... .... .... ....   .... .... .... ....   0
s07 tambourine .... .... .... ....   .... .... .... ....   .... .... .... ....   .. .. .. .. .. ..   .... .... .... ....   .... .... .... ....   0
s08            .... .... .... ....   .... .... .... ....   .... .... .... ....   .. .. .. .. .. ..   .... .... .... ....   .... .... .... ....   0

s09            .... .... .... ....   .... .... .... ....   .... .... .... ....   .. .. .. .. .. ..   .... .... .... ....   .... .... .... ....   0
s10            .... .... .... ....   .... .... .... ....   .... .... .... ....   .. .. .. .. .. ..   .... .... .... ....   .... .... .... ....   0
s11            .... .... .... ....   .... .... .... ....   .... .... .... ....   .. .. .. .. .. ..   .... .... .... ....   .... .... .... ....   0
s12            .... .... .... ....   .... .... .... ....   .... .... .... ....   .. .. .. .. .. ..   .... .... .... ....   .... .... .... ....   0
s13            .... .... .... ....   .... .... .... ....   .... .... .... ....   .. .. .. .. .. ..   .... .... .... ....   .... .... .... ....   0
s14            .... .... .... ....   .... .... .... ....   .... .... .... ....   .. .. .. .. .. ..   .... .... .... ....   .... .... .... ....   0
s15            .... .... .... ....   .... .... .... ....   .... .... .... ....   .. .. .. .. .. ..   .... .... .... ....   .... .... .... ....   0
s16            .... .... .... ....   .... .... .... ....   .... .... .... ....   .. .. .. .. .. ..   .... .... .... ....   .... .... .... ....   0

s17            .... .... .... ....   .... .... .... ....   .... .... .... ....   .. .. .. .. .. ..   .... .... .... ....   .... .... .... ....   0
s18            .... .... .... ....   .... .... .... ....   .... .... .... ....   .. .. .. .. .. ..   .... .... .... ....   .... .... .... ....   0
s19            .... .... .... ....   .... .... .... ....   .... .... .... ....   .. .. .. .. .. ..   .... .... .... ....   .... .... .... ....   0
s20            .... .... .... ....   .... .... .... ....   .... .... .... ....   .. .. .. .. .. ..   .... .... .... ....   .... .... .... ....   0
s21            .... .... .... ....   .... .... .... ....   .... .... .... ....   .. .. .. .. .. ..   .... .... .... ....   .... .... .... ....   0
s22            .... .... .... ....   .... .... .... ....   .... .... .... ....   .. .. .. .. .. ..   .... .... .... ....   .... .... .... ....   0
s23            .... .... .... ....   .... .... .... ....   .... .... .... ....   .. .. .. .. .. ..   .... .... .... ....   .... .... .... ....   0
s24            .... .... .... ....   .... .... .... ....   .... .... .... ....   .. .. .. .. .. ..   .... .... .... ....   .... .... .... ....   0
'''
p=t32.find('kick      ')
d=147
sampleNames=[]
matrix=[]
for i in range(24):
  if t32[p+i/8+i*d:p+i/8+i*d+10].split(' ')[0]!='':
    sampleNames+=[t32[p+i/8+i*d:p+i/8+i*d+10].split(' ')[0]]
  matrix+=[[t32[p+i/8+i*d:p+i/8+i*d+10].split(' ')[0]]+t32[p+i/8+i*d+11:p+i/8+i*d+d-4].split('   ')]
#print sampleNames
#print 'bpm', t32.split('\n')[0].split(' ')[2]
score=[]
for m in matrix:
  instrument=m[0]
  bar0=re.sub(' ', '', m[1])
  bar1=re.sub(' ', '', m[2])
  bar4=m[3].split(' ')
  bar8=m[4].split(' ')
  song1=re.sub(' ', '', m[5])
  song2=re.sub(' ', '', m[6])
  song =song1+song2
  state=re.sub('\n', '', m[7])
  if instrument!='':
    song=re.sub('A',bar8[0],song)
    song=re.sub('B',bar8[1],song)
    song=re.sub('C',bar8[2],song)
    song=re.sub('D',bar8[3],song)
    song=re.sub('E',bar8[4],song)
    song=re.sub('F',bar8[5],song)
    song=re.sub('a',bar4[0],song)
    song=re.sub('b',bar4[1],song)
    song=re.sub('c',bar4[2],song)
    song=re.sub('d',bar4[3],song)
    song=re.sub('1',bar1,song)
    song=re.sub('0',bar0,song)
    score+=[[instrument]+[song]]
#  print bar0
#  print bar1  
import orchestra
print '$instrument('+'kick'+"'"+'1'+')'
print '$instrument('+'snare'+"'"+'2'+')'
import orchestra2
#for i in score:
#  print i
def convert(instrument,ii):
  t=0
  for i in ii:
    if i=='1':
      print 'i"'+instrument+'"', t*0.25, 1, 0, 0, 0, 0
    if i=='2':
      print 'i"'+instrument+'"', t*0.25, 1, 1, 0, 0, 0
    if i=='3':
      print 'i"'+instrument+'"', t*0.25, 1, 0, 1, 0, 0
    if i=='4':
      print 'i"'+instrument+'"', t*0.25, 1, 0, 0, 1, 0
    if i=='5':
      print 'i"'+instrument+'"', t*0.25, 1, 0, 0, 0, 1
    if i=='6':
      print 'i"'+instrument+'"', t*0.25, 1, 1, 0, 1, 0
    if i=='7':
      print 'i"'+instrument+'"', t*0.25, 1, 1, 0, 0, 1
    if i=='8':
      print 'i"'+instrument+'"', t*0.25, 1, 0, 1, 1, 0
    if i=='9':
      print 'i"'+instrument+'"', t*0.25, 1, 0, 1, 0, 1
    t+=1
for i in score:
  convert(i[0],i[1])
print '</CsScore>'
print '</CsoundSynthesizer>'

